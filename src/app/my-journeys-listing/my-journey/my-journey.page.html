<app-application-header [config]="headerConfig"></app-application-header>

<ion-content [fullscreen]="true">
    <div class="journey-name" >
      <h1  >{{programName}}</h1>
    </div>
    <ion-segment class="custom-segment" (ionChange)="segmentChanged($event)" value="inProgress">
      <ion-segment-button value="inProgress">
        <ion-label>{{"ONGOING" | translate}}</ion-label>
      </ion-segment-button>
      <ion-segment-button value="completed">
        <ion-label>{{"COMPLETED" | translate}}</ion-label>
      </ion-segment-button>
    </ion-segment>

    @if (selectedSegment === 'inProgress') {
      @if (myJourneyInprogress.length > 0) {
          <div class="cards-list ion-margin">
          @for (item of myJourneyInprogress; track $index) {
            <div class="ongoing-card" (click)="navigateproject(item._id)">
              <div class="ongoing-head">
                <div>
                  @if (item.endDate) {
                    <p>{{"DUE_DATE" | translate}}: {{ item.endDate | date:'dd/MM/yy' }}</p>
                  }
                </div>
                <span>
                  <button>
                    <mat-icon>arrow_forward</mat-icon>
                  </button>
                </span>
              </div>
              <div class="ongoing-title">
                <p>{{item.title | shortUrl:45}}</p>
              </div>
              <div class="progress-bar">
                <span class="progress-text">{{ calculateProgress(item) }}%</span>
                <div class="progress">
                  <div
                    class="progress-fill"
                    [style.width]="calculateProgress(item) + '%'"
                  ></div>
                    </div>
                </div>
            </div>
          }
        </div>
        }
        @else {
          <app-no-data [message]="'NO_DATA_MSG'"></app-no-data>
        }
        <ion-infinite-scroll (ionInfinite)="loadOngoingData($event)" [disabled]="disableLoading">
          <ion-infinite-scroll-content loadingText="{{'LOADING' | translate}}..." loadingSpinner="bubbles"></ion-infinite-scroll-content>
        </ion-infinite-scroll>
    }
    @else if (selectedSegment === 'completed') {
      @if (myJourneyCompleted.length > 0) {
          <div class="cards-list ion-margin">
          @for (item of myJourneyCompleted; track $index) {
            <app-recommendation-card [cardData]="item" [type]="'journey'"></app-recommendation-card>
          }
        </div>
        }
        @else {
          <app-no-data [message]="'NO_DATA_MSG'"></app-no-data>
        }
        <ion-infinite-scroll (ionInfinite)="loadCompletedData($event)" [disabled]="disableLoading">
          <ion-infinite-scroll-content loadingText="{{'LOADING' | translate}}..." loadingSpinner="bubbles"></ion-infinite-scroll-content>
        </ion-infinite-scroll>
    }
</ion-content>
